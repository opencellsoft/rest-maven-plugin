# rest-maven-plugin 

***froked from https://github.com/cjnygard/rest-maven-plugin***

Welcome to the rest-maven-plugin plugin for Apache Maven 3.

This plugin is meant to provide an easy way to convert java files to script instance json format and deploy it into opencell via REST URL.

## Getting started with the plugin :

To use this plugin and start working with the rest request, in the pom.xml :

* add properties 
```xml
 <properties>
        <opencell.url>http://localhost:8080</opencell.url>
        <!--opencell's username:password encoded with base64 -->
        <opencell.authorization>b3BlbmNlbGwuc3VwZXJhZG1pbjpvcGVuY2VsbC5zdXBlcmFkbWlu</opencell.authorization>
        <rest-maven-plugin.version>0.1.6</rest-maven-plugin.version>
        <opencell.path>/opencell/api/rest/scriptInstance/createOrUpdate</opencell.path>
    </properties>
```

* delcate a profile
```xml
<profile>
	<id>deploy-script</id>
	<build>
		<plugins>
			<plugin>
				<groupId>com.opencellsoft.plugins</groupId>
				<artifactId>rest-maven-plugin</artifactId>
				<version>${rest-maven-plugin.version}</version>
				<configuration>
					<endpoint>${opencell.url}</endpoint>
					<resource>${opencell.path}</resource>
					<method>POST</method>
					<saveResponse>false</saveResponse>
					<inputDir>${project.basedir}/src/main/java/com/opencellsoft/service/engie/notif</inputDir>
					<javaFile>${project.basedir}/src/main/java/org/meveo/service/script/DeleteCustomersScript.java</javaFile>
					<outputDir>${project.build.directory}/scripts/</outputDir>
					<headers>
						<Authorization>Basic ${opencell.authorization}</Authorization>
					</headers>
					<requestType>
						<type>application</type>
						<subtype>json</subtype>
					</requestType>
					<fileset>
						<directory>${project.build.directory}/scripts/</directory>
						<includes>
							<include>*.json</include>
						</includes>
					</fileset>
				</configuration>
				<dependencies>
					<dependency>
						<groupId>com.opencellsoft.plugins</groupId>
						<artifactId>rest-maven-plugin</artifactId>
						<version>${rest-maven-plugin.version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
</profile>
```

* run this command :
`mvn rest:rest-request -P  deploy-script`

# Plugin configuration : 
## Script generation configuration :
### Adding java class or package 
To specify the input package or class you can add the following configuration: 

* To use a single java file:
`mvn rest:rest-request -P  deploy-script -DjavaFile=/src/main/java/org/meveo/service/script/DeleteCustomersScript.java`

* To use a package recursively:
`mvn rest:rest-request -P  deploy-script -DinputDir=/src/main/java/org/meveo/service/script/`

* Or update profile declaration in pom.xml
```xml
<inputDir>${project.basedir}/src/main/java/com/opencellsoft/service/engie/notif</inputDir>
```
```xml
<javaFile>${project.basedir}/src/main/java/org/meveo/service/script/DeleteCustomersScript.java</javaFile>
```

### Specify the output directory : 
The out put directory is used for saving the generated json's files. 
`<outputDir>${project.build.directory}/scripts/</outputDir>`
## Rest request configuration 
### Specify the opencell server and rest path : 
* the end point param means the opencell server
```xml
<endpoint>http://localhost:8080</endpoint>
```
* the resource param means the Rest Path 
```xml
<resource>/opencell/api/rest/scriptInstance/createOrUpdate</resource>
```
* the method param means the rest method [GET, POST, DELETE,...]
```xml
<method>POST</method>
```

* the **saveResponse** param is used for saving the response response, default false. 

`<saveResponse>false</saveResponse>`

* the headers contains the basic authorisation for authentification.

```xml
<headers>
    <Authorization>Basic G1pbjpvcGVuY2VsbC5zdXBlcmFkbWlu......</Authorization>
</headers>
```

* the request type used :
```xml
<requestType>
    <type>application</type>
    <subtype>json</subtype>
</requestType>
```

* The input directory for reading all json files  generated by the plugin or manualy  : 

```xml
<fileset>
 <directory>${project.build.directory}/scripts/</directory>
    <includes>
        <include>*.json</include>
    </includes>
</fileset>
```